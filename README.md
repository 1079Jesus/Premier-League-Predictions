# Predicting the Premier League Standings Using Neural Networks

I built this project using Jupyter Notebook and wrote a short [Medium Article](https://medium.com/@jesus.contrerasmagana/predicting-the-premier-league-standings-using-neural-networks-c5516dba7604
) explaining my methodology and findings. The text of the article is also found below.


## Intro
Football fans all over the world are convinced they can accurately predict football match results. They even “know” which team will be the champions of the league or tournament. These sports fanatics do it either because they love “the beautiful game,” to prove their football knowledge to their friends, profit from betting on the sport and/or all of the above. However, football is unpredictable with black horses (team revelations) and unprecedented occurrences. The English Premier League, the first division of the English football league system, exemplifies this unforeseeable phenomena. For example, Leicester City won the 2015–2016 league despite being promoted to the Premier League only two years earlier while Liverpool failed to win the Premier League in the 2018–2019 season despite finishing the season with 97 points (the 3rd all time highest, behind Manchester City’s 98 point coronation that year and Manchester City’s historic 100 point 2017–2018 league title). For this reason, I have decided to train a neural network using the match results of previous seasons to predict the Premier League Standings of the following year.

## Football
However, before proceeding, we need to understand the sport further and clarify that when I say “football,” I am referring to what the world knows as football and not soccer as it is (mysteriously) known in the United States. The sport consists of two teams with 10 field players and one goalie. The result of a match is determined by the number of goals a team scores by getting the ball passed the goal line the opponent is defending. A game consists of two halves of 45 minutes each and switching sides at half time. The final result is determined by the final score indicating a team win, loss or tie. Nevertheless, if the game is an elimination match or tournament final, then there is extra time and/or penalties to break the tie, but this is not relevant to the Premier League which allows draws and therefore, there is no need to account for elimination fixtures in our model.

## Premier League
The Premier League standings table sums 3 points to the winning team, 1 for a tie and 0 for a loss to sort the 20 teams in the competition. There are a total of 38 matches in a season, playing each team twice in home and away fixtures. According to Premier League regulation, the Premier League table breaks ties in points by using the goal difference (total goals scored minus total goals conceded in the season), if there is still a tie then the total number of goals scored is used to rank the teams and in the unlikely case that there is still a tie, the teams are “awarded the same position in the table.” The first place team is the champion of the league while the bottom three teams are relegated and their vacant spot is filled with the three teams promoted from the Championship, the second division of the English football league system. If interested, more information can be found at https://www.premierleague.com/premier-league-explained but we have already covered the fundamentals needed to understand this project.

## Data
I used data.world to get the 2015–2016, 2016–2017, 2017–2018 and 2018–2019 Premier League Match results. The following is a secure download link of the 2017–2018 csv file: https://query.data.world/s/wxbeoargbmtyy7t3s3xw5tksxxggcj. The file was sorted chronologically and had lots of information but I was only interested in the HomeTeam, AwayTeam, FTHG (full time home goals), FTAG (full time away goals) and FTR (full time result) columns because there was no need to know who the referee was or the number of home red cards, for example.

The full time result was decided by comparing the full time home goals with the full time away goals indicating either a home win (H), away win (A) or draw (D). I then used this data to replicate the Premier League table for the corresponding season by also calculating the total goals scored and conceded.

## Preprocessing
When recreating the table, I also computed my inputs for my neural network. Those ended up being the home win rates (total home wins divided by 19), away win rates (total away wins divided by 19), average goals scored (total goals scored divided by 38), average goals conceded (total goals scored divided by 38) and the current season finish. I decided these were the most important features to include as inputs to my neural network when simulating a match. The reason being that these inputs give numerical values representing a team’s strength while playing at home, when playing away as well as the relative attacking and defensive strength. I also incorporated the current season finish in my inputs to factor the obvious prediction that the first place team will likely win a game against the last place team.

## Neural Network Architecture
I decided to use a simple feed forward neural network with 8 inputs and 2 outputs. The 8 inputs being the average goals scored/conceded, previous position and home/away win rates, depending on the location, per team. The 2 outputs represented the goals scored by the home and away team. However, given the fact that there were newly promoted teams without a position in the previous season, I decided to assign a random integer between 20 and 30 as the previous position in order to emphasize that the team was not a part of the 20 teams in the previous season but also allowing for variability so the neural network does not treat these teams the same. Furthermore, for the average goals scored/conceded and home/away win rates of these newly promoted teams, I opted to use the average of the last 10 teams performance in the previous season, to allow for variability but also reinforcing the generalization that newly promoted teams tend to struggle during their first year back in the Premier League.

I opted to have 3 hidden layers as I progressed from input to output layer. I realized that my model performed better when I increment the number of hidden layers but after 3 hidden layers I didn’t see any major improvements in my predictions because the top 6 teams tended to be inline with the actual standings as well as the bottom 5 teams. Therefore, I simply reduced the number of units for Dense(), which represented the matrix vector multiplication for the neural network to learn, by half until I reached an output layer of 2 units.

I proceeded to use ‘adam’ as my optimizer to control the learning rate of my model as the optimal weights for the model were calculated. I decided to use the adam optimizer given that it is generally a good optimizer for many uses and because predicting the Premier League didn’t have any special features that would benefit greatly from another optimizer. I used the standard loss function for regression problems given that my output was meant to represent the score of the match so a binary and multi-class classification did not make sense to use in this case. I also incorporated an early stop so the model would stop training if it no longer improved. Furthermore, once the neural network was compiled, I trained the model by attempting to predict the 2016–2017 match results using the 2015–2016 data (home/away win rates, average goals scored/conceded, previous league finishes). I then successively called model.fit to incrementally train the model in order to have a trained neural network to predict the 2018–2019 league standings.

## Predictions
My model generally performed well in predicting the order of the teams, for example, Manchester City placed first and Liverpool placed second as it actually happened. This was the part that I was most interested in given that I knew it would be very difficult to achieve a high accuracy for the points and goal difference. However, I did find that my model was particularly harsh with the newly promoted teams (Wolves, Cardiff and Fulham) but I wasn’t upset with this performance because Cardiff and Fulham were actually relegated and Wolves ended up being a revelation that season.

Also, out of curiosity, I decided to predict this season’s standings. I corrected/modified a database (Matchday 5 incorrectly had Southampton vs Everton when the game should have been Bournemouth vs Everton, https://soccersoda.com/soccer-leagues-fixtures/#C4) including all the league fixtures for the 2019–2020 season and used model.fit once more so my model could now incorporate the 2018–2019 season. However, this year’s season has been a major surprise given Liverpool’s current lead over 2nd place Manchester City. The league has been suspended because of the current pandemic and therefore, may or may not resume. As a result, we may or may not know how well my model did, however, it did not predict such a large gap between the first place team and the remainder of the league, exemplifying why it is so difficult to make predictions in football.

## Reflections
Overall, I was really satisfied with my predictions because the Premier League standings were very similar to the actual results. However, I wish I could have successfully incorporated face-to-face match ups in my neural network. I attempted to do this by incorporating the percentage of wins, losses and draws in matches between two teams but my model was giving these inputs too much weight. As a result, the team with a higher winning percentage most of the time won the match which was giving predictions far too similar to those of the previous season.
